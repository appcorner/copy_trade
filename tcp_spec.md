**TCP Message Specification V6 (Text/Pipe Format)** ‡∏â‡∏ö‡∏±‡∏ö‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î `tcp_server.ex`

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô EA (MQL5) ‡∏ó‡∏±‡πâ‡∏á‡∏ù‡∏±‡πà‡∏á Master ‡πÅ‡∏•‡∏∞ Slave ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö Server ‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á

---

### üìã ‡∏Å‡∏é‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (General Rules)

1. **Format:** Text String
2. **Separator:** ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ Pipe `|` ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡πà‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. **Terminator:** ‡∏à‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ `\n` (Newline) ‡∏´‡∏£‡∏∑‡∏≠ `\r\n` ‡πÄ‡∏™‡∏°‡∏≠ 
4. **Encoding:** UTF-8 / ASCII

---

### 1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ (Authentication & Setup)

#### 1.1 ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (Login)

‡∏™‡πà‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Socket ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à

* **Format:** `AUTH:API_KEY` 
* **Example:** `AUTH:sk_live_123456`

**Server Response:**

* Success: `AUTH_OK` 
* Fail: `AUTH_FAILED` 

#### 1.2 ‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° (Subscription) - *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Follower ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô*

‡∏™‡πà‡∏á‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Login ‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ï‡∏≤‡∏° Master ‡∏Ñ‡∏ô‡πÑ‡∏´‡∏ô

* **Format:** `SUBSCRIBE:MASTER_TOKEN` 
* **Example:** `SUBSCRIBE:MST_998877`

**Server Response:**

* Success: `SUBSCRIBE_OK` 
* Fail: `ERROR:INVALID_TOKEN` 

---

### 2. ‡∏ù‡∏±‡πà‡∏á Master (Master -> Server)

Master EA ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ö‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï

#### 2.1 ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Open Signal)

* **Format:** `SIGNAL_OPEN|TYPE|SYMBOL|PRICE|VOLUME|SL|TP|TICKET` 

* **Parameters:**
  * `TYPE`: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (`BUY` ‡∏´‡∏£‡∏∑‡∏≠ `SELL`)
  * `SYMBOL`: ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡πÄ‡∏á‡∏¥‡∏ô (‡πÄ‡∏ä‡πà‡∏ô `XAUUSD`, `EURUSD`)
  * `PRICE`: ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á (Float)
  * `VOLUMN`: lot ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á (Float)
  * `SL`: ‡∏£‡∏≤‡∏Ñ‡∏≤ SL ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á (Float)
  * `TP`: ‡∏£‡∏≤‡∏Ñ‡∏≤ TP ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á (Float)
  * `TICKET`: ‡πÄ‡∏•‡∏Ç Ticket ID ‡∏ö‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï Master (Integer)

* **Example:** `SIGNAL_OPEN|BUY|XAUUSD|2030.50|0.01|2020.50|2040.50|10001`

#### 2.2 ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Close Signal)

* **Format:** `SIGNAL_CLOSE|SYMBOL|TICKET` 

* **Parameters:**
  * `SYMBOL`: ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡πÄ‡∏á‡∏¥‡∏ô
  * `TICKET`: ‡πÄ‡∏•‡∏Ç Ticket ID ‡∏Ç‡∏≠‡∏á Master ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î

* **Example:** `SIGNAL_CLOSE|XAUUSD|10001`

---

### 3. ‡∏ù‡∏±‡πà‡∏á Slave (Slave -> Server)

Slave EA ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡∏£‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô

#### 3.1 ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Ack Open)

‡∏™‡πà‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Server ‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà Ticket

* **Format:** `ACK_OPEN|MASTER_TICKET|SLAVE_TICKET|VLOUMN|TYPE 

* **Parameters:**
  * `MASTER_TICKET`: Ticket ‡∏Ç‡∏≠‡∏á Master ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á
  * `SLAVE_TICKET`: Ticket ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡πÑ‡∏î‡πâ‡∏ö‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï Follower
  * `VOLUMN`: lot ‡∏ó‡∏µ‡πà Follower ‡πÄ‡∏õ‡∏¥‡∏î (Float)
  * `TYPE`: type ‡∏ó‡∏µ‡πà Follower ‡πÄ‡∏õ‡∏¥‡∏î

* **Example:** `ACK_OPEN|10001|50009|0.01|BUY`

#### 3.2 ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Ack Close)

‡∏™‡πà‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô

* **Format:** `ACK_CLOSE|MASTER_TICKET|PRICE|PROFIT` 

* **Parameters:**
  * `MASTER_TICKET`: Ticket ‡∏Ç‡∏≠‡∏á Master (‡πÉ‡∏ä‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)
  * `PRICE`: ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (Float)
  * `PROFIT`: ‡∏Å‡∏≥‡πÑ‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏á‡∏¥‡∏ô (Float)

* **Example:** `ACK_CLOSE|10001|2035.00|15.50`

---

### üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏£‡∏≤‡∏á Data Type

| Field | Type | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
| --- | --- | --- |
| `API_KEY` | String | ‡∏Ñ‡∏µ‡∏¢‡πå‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß User |
| `MASTER_TOKEN` | String | ‡πÇ‡∏Ñ‡πâ‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß Master |
| `TYPE` | String | "BUY" ‡∏´‡∏£‡∏∑‡∏≠ "SELL" |
| `SYMBOL` | String | ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡πÄ‡∏á‡∏¥‡∏ô (e.g. "BTCUSD") |
| `PRICE` | Float | ‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° (e.g. 1.2345) |
| `PROFIT` | Float | ‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° (‡∏ï‡∏¥‡∏î‡∏•‡∏ö‡πÑ‡∏î‡πâ) |
| `TICKET` | Integer | ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡πá‡∏° |

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö MQL5:**
‡πÉ‡∏ô EA ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö (Slave) ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `StringSplit` ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ delimiter ‡πÄ‡∏õ‡πá‡∏ô `'|'` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö Index ‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô